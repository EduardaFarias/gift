<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feliz formatura :) </title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- √ÅUDIO (tenta tocar automaticamente ao carregar) -->
    <audio id="intro-audio" src="audio/festa.mp3" preload="auto"></audio>

    <!-- TELA DE ENTRADA -->
    <div id="intro-overlay" class="overlay">
        <div class="overlay-content">
            <h2 class="overlay-title">Oiee, surpresa üéâ  <br>Clica em qualquer lugar da tela pra ativar o √°udio<br>  </h2>
            <p class="overlay-subtitle">
                Tem gatinho girando, confete e musiquinha s√≥ pra voc√™
            </p>

            <div class="cat-wrapper">
                <img src="img/gatito.gif" alt="Gatinho fofo" class="cat-gif" id="catGif">
            </div>

            <!-- Bot√£o s√≥ navega pra outra p√°gina -->
            <a href="paginas/fofinhi.html" class="start-btn">
                Come√ßar üéÅ
            </a>
        </div>
    </div>

    <!-- CONTE√öDO NORMAL DO SITE -->
    <main>
        <h1>Bem-vindo ao meu site!</h1>
        <p><a href="sobre.html">Sobre</a></p>
        <p><a href="paginas/contato.html">Contato</a></p>
        <p><a href="paginas/produtos.html">Produtos</a></p>
    </main>

    <!-- Biblioteca de confete -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

  <script>
    window.addEventListener("load", function () {
        const audio  = document.getElementById("intro-audio");
        const catGif = document.getElementById("catGif");

        // üê± Gatinho gira/cresce
        if (catGif) {
            catGif.classList.remove("animate"); 
            void catGif.offsetWidth;           
            catGif.classList.add("animate");   
        }

        // üéâ Confetti (mantive igual)
        function startConfetti(durationMs = 2600) {
            if (!window.confetti) return;
            const end = Date.now() + durationMs;
            (function frame() {
                confetti({ particleCount: 6, angle: 60, spread: 55, origin: { x: 0 } });
                confetti({ particleCount: 6, angle: 120, spread: 55, origin: { x: 1 } });
                if (Date.now() < end) {
                    requestAnimationFrame(frame);
                }
            })();
        }
        startConfetti();

        // üéµ L√ìGICA DE √ÅUDIO INTELIGENTE
        if (!audio) return;

        const SEGMENT1_END   = 1.0;  
        const SEGMENT2_START = 3.5;  
        const SEGMENT2_END   = 22.5; 

        audio.currentTime = 0;

        // Fun√ß√£o que gerencia o pulo do tempo
        function onTimeUpdate() {
            const t = audio.currentTime;
            if (t >= SEGMENT1_END && t < SEGMENT2_START) {
                audio.currentTime = SEGMENT2_START;
                return;
            }
            if (t >= SEGMENT2_END) {
                audio.pause();
                audio.currentTime = SEGMENT2_END;
                audio.removeEventListener("timeupdate", onTimeUpdate);
            }
        }
        audio.addEventListener("timeupdate", onTimeUpdate);

        // --- AQUI EST√Å A M√ÅGICA ---
        // Tenta tocar automaticamente
        const playPromise = audio.play();

        if (playPromise !== undefined) {
            playPromise.catch(error => {
                console.log("Autoplay bloqueado. Aguardando intera√ß√£o...");
                
                // Cria um "ouvinte" que espera o primeiro clique na tela inteira
                const unlockAudio = () => {
                    audio.play();
                    // Remove o ouvinte para n√£o tentar tocar de novo a cada clique
                    document.removeEventListener('click', unlockAudio);
                    document.removeEventListener('touchstart', unlockAudio); // Para celular
                };

                // Adiciona o ouvinte no documento todo
                document.addEventListener('click', unlockAudio);
                document.addEventListener('touchstart', unlockAudio);
            });
        }
    });
</script>
</body>
</html>
